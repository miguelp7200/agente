[2025-09-05 00:54:44] [INFO] 🚀 Iniciando diagnóstico de backends...
[2025-09-05 00:54:44] [INFO] 📋 Backend A: https://invoice-backend-yuhrx5x2ra-uc.a.run.app
[2025-09-05 00:54:44] [INFO] 📋 Backend B: https://invoice-backend-819133916464.us-central1.run.app
[2025-09-05 00:54:44] [INFO] 📂 Directorio de tests: tests
[2025-09-05 00:54:44] [INFO] 📁 Directorio de output: diagnosis_results
[2025-09-05 00:54:44] [INFO] 🔐 Obteniendo token de autenticación...
[2025-09-05 00:54:50] [SUCCESS] ✅ Token obtenido exitosamente
[2025-09-05 00:54:50] [INFO] 🔍 Probando conectividad con backends...
[2025-09-05 00:54:50] [INFO] [Backend-A] 🔍 Probando conectividad con Backend-A...
[2025-09-05 00:54:50] [INFO] [Backend-A] 📝 Creando sesión de test: connectivity-test-005450...
[2025-09-05 00:54:50] [SUCCESS] [Backend-A] ✅ Sesión creada exitosamente
[2025-09-05 00:54:50] [INFO] [Backend-A] 🔍 Probando endpoint /run...
[2025-09-05 00:54:55] [SUCCESS] [Backend-A] ✅ Conectividad OK - ADK responde correctamente
[2025-09-05 00:54:55] [INFO] [Backend-B] 🔍 Probando conectividad con Backend-B...
[2025-09-05 00:54:55] [INFO] [Backend-B] 📝 Creando sesión de test: connectivity-test-005455...
[2025-09-05 00:54:55] [SUCCESS] [Backend-B] ✅ Sesión creada exitosamente
[2025-09-05 00:54:55] [INFO] [Backend-B] 🔍 Probando endpoint /run...
[2025-09-05 00:54:58] [SUCCESS] [Backend-B] ✅ Conectividad OK - ADK responde correctamente
[2025-09-05 00:54:58] [INFO] 📂 Cargando casos de test desde: tests
[2025-09-05 00:54:58] [INFO] 📄 Procesando archivo: estadisticas_ruts_unicos.test.json
[2025-09-05 00:54:58] [SUCCESS] ✅ Test cargado: estadisticas_ruts_unicos.test
[2025-09-05 00:54:58] [INFO] 📄 Procesando archivo: facturas_cedible_cf_0012148561.test.json
[2025-09-05 00:54:58] [SUCCESS] ✅ Test cargado: Test: Factura cedible CF por solicitante 0012148561
[2025-09-05 00:54:58] [INFO] 📄 Procesando archivo: facturas_cedible_sf_0012148561.test.json
[2025-09-05 00:54:58] [SUCCESS] ✅ Test cargado: Test: Factura cedible SF por solicitante 0012148561
[2025-09-05 00:54:58] [INFO] 📄 Procesando archivo: facturas_cedibles_multiples_0012148561.test.json
[2025-09-05 00:54:58] [SUCCESS] ✅ Test cargado: Test: Facturas cedibles múltiples por solicitante 0012148561
[2025-09-05 00:54:58] [INFO] 📄 Procesando archivo: facturas_estadisticas_ruts.test.json
[2025-09-05 00:54:58] [SUCCESS] ✅ Test cargado: facturas_estadisticas_ruts.test
[2025-09-05 00:54:58] [INFO] 📄 Procesando archivo: facturas_fecha_especifica_2019-12-26.test.json
[2025-09-05 00:54:58] [SUCCESS] ✅ Test cargado: Test: Búsqueda por fecha específica 2019-12-26
[2025-09-05 00:54:58] [INFO] 📄 Procesando archivo: facturas_mes_year_diciembre_2019.test.json
[2025-09-05 00:54:58] [SUCCESS] ✅ Test cargado: Test: Búsqueda por Mes y Año Específico
[2025-09-05 00:54:58] [INFO] 📄 Procesando archivo: facturas_multiple_ruts.test.json
[2025-09-05 00:54:58] [SUCCESS] ✅ Test cargado: Test: Búsqueda por Múltiples RUTs
[2025-09-05 00:54:58] [INFO] 📄 Procesando archivo: facturas_rango_fechas_diciembre_2019.test.json
[2025-09-05 00:54:58] [SUCCESS] ✅ Test cargado: Test: Búsqueda por rango de fechas diciembre 2019
[2025-09-05 00:54:58] [INFO] 📄 Procesando archivo: facturas_recent_by_date.test.json
[2025-09-05 00:54:58] [SUCCESS] ✅ Test cargado: Test: Búsqueda de Facturas Más Recientes
[2025-09-05 00:54:58] [INFO] 📊 Total de casos de test cargados: 10
[2025-09-05 00:54:58] [INFO] 🧪 Iniciando ejecución de tests...
[2025-09-05 00:54:58] [INFO] 🔄 Test 1/10: estadisticas_ruts_unicos.test
[2025-09-05 00:54:58] [INFO] [Backend-A] 📤 Enviando consulta: 'Dame estadísticas de los RUTs con más facturas, mo...'
[2025-09-05 00:54:58] [INFO] [Backend-A] 📝 Creando sesión: diagnosis-session-20250905_005444-Backend-A-2047480632...
[2025-09-05 00:54:59] [SUCCESS] [Backend-A] ✅ Sesión creada
[2025-09-05 00:54:59] [INFO] [Backend-A] 🔗 Enviando a /run endpoint...
[2025-09-05 00:54:59] [INFO] [Backend-A] ⏱️ Enviando consulta (timeout: 300s para procesamiento completo)...
[2025-09-05 00:55:06] [INFO] [Backend-A] 🔍 DEBUG: Respuesta es array con 3 eventos
[2025-09-05 00:55:06] [INFO] [Backend-A] 🔍 DEBUG: Encontrados 1 eventos del modelo
[2025-09-05 00:55:06] [INFO] [Backend-A] 🔍 DEBUG: Texto extraído: 'Aquí están las estadísticas de los RUTs con al menos 2 facturas:

*   **RUT: 76742300-4**
    *   Pr...'
[2025-09-05 00:55:06] [SUCCESS] [Backend-A] ✅ Respuesta recibida (6983.6442ms,  chars)
[2025-09-05 00:55:06] [INFO] [Backend-B] 📤 Enviando consulta: 'Dame estadísticas de los RUTs con más facturas, mo...'
[2025-09-05 00:55:06] [INFO] [Backend-B] 📝 Creando sesión: diagnosis-session-20250905_005444-Backend-B-1414629486...
[2025-09-05 00:55:06] [SUCCESS] [Backend-B] ✅ Sesión creada
[2025-09-05 00:55:06] [INFO] [Backend-B] 🔗 Enviando a /run endpoint...
[2025-09-05 00:55:06] [INFO] [Backend-B] ⏱️ Enviando consulta (timeout: 300s para procesamiento completo)...
[2025-09-05 00:55:13] [INFO] [Backend-B] 🔍 DEBUG: Respuesta es array con 3 eventos
[2025-09-05 00:55:13] [INFO] [Backend-B] 🔍 DEBUG: Encontrados 1 eventos del modelo
[2025-09-05 00:55:13] [INFO] [Backend-B] 🔍 DEBUG: Texto extraído: 'Aquí tienes las estadísticas de los RUTs con al menos 2 facturas:

*   **Rut:** 76742300-4
    *   P...'
[2025-09-05 00:55:13] [SUCCESS] [Backend-B] ✅ Respuesta recibida (6907.4916ms,  chars)
[2025-09-05 00:55:13] [ANALYSIS] 📈 Comparación - Proxy URLs: A=0, B=0 | Signed URLs: A=0, B=0
[2025-09-05 00:55:13] [INFO] ⏸️ Pausa de 5 segundos antes del siguiente test...
[2025-09-05 00:55:18] [INFO] 🔄 Test 2/10: Test: Factura cedible CF por solicitante 0012148561
[2025-09-05 00:55:18] [INFO] [Backend-A] 📤 Enviando consulta: 'Puedes darme la factura cedible cf cuyo solicitant...'
[2025-09-05 00:55:18] [INFO] [Backend-A] 📝 Creando sesión: diagnosis-session-20250905_005444-Backend-A-445390094...
[2025-09-05 00:55:18] [SUCCESS] [Backend-A] ✅ Sesión creada
[2025-09-05 00:55:18] [INFO] [Backend-A] 🔗 Enviando a /run endpoint...
[2025-09-05 00:55:18] [INFO] [Backend-A] ⏱️ Enviando consulta (timeout: 300s para procesamiento completo)...
[2025-09-05 00:55:21] [INFO] [Backend-A] 🔍 DEBUG: Respuesta es array con 3 eventos
[2025-09-05 00:55:21] [INFO] [Backend-A] 🔍 DEBUG: Encontrados 1 eventos del modelo
[2025-09-05 00:55:21] [INFO] [Backend-A] 🔍 DEBUG: Texto extraído: 'No se encontraron facturas cedibles con firma para el solicitante 0012148561....'
[2025-09-05 00:55:21] [SUCCESS] [Backend-A] ✅ Respuesta recibida (2360.8851ms,  chars)
[2025-09-05 00:55:21] [ERROR] [Backend-A] ❌ Error enviando consulta: Cannot find drive. A drive with the name 'diagnosis_results\response_Backend-A_Test' does not exist.
[2025-09-05 00:55:21] [INFO] [Backend-B] 📤 Enviando consulta: 'Puedes darme la factura cedible cf cuyo solicitant...'
[2025-09-05 00:55:21] [INFO] [Backend-B] 📝 Creando sesión: diagnosis-session-20250905_005444-Backend-B-604036339...
[2025-09-05 00:55:21] [SUCCESS] [Backend-B] ✅ Sesión creada
[2025-09-05 00:55:21] [INFO] [Backend-B] 🔗 Enviando a /run endpoint...
[2025-09-05 00:55:21] [INFO] [Backend-B] ⏱️ Enviando consulta (timeout: 300s para procesamiento completo)...
[2025-09-05 00:55:24] [INFO] [Backend-B] 🔍 DEBUG: Respuesta es array con 3 eventos
[2025-09-05 00:55:24] [INFO] [Backend-B] 🔍 DEBUG: Encontrados 1 eventos del modelo
[2025-09-05 00:55:24] [INFO] [Backend-B] 🔍 DEBUG: Texto extraído: 'No se encontraron facturas cedibles con firma para el solicitante 0012148561....'
[2025-09-05 00:55:24] [SUCCESS] [Backend-B] ✅ Respuesta recibida (2497.0346ms,  chars)
[2025-09-05 00:55:24] [ERROR] [Backend-B] ❌ Error enviando consulta: Cannot find drive. A drive with the name 'diagnosis_results\response_Backend-B_Test' does not exist.
[2025-09-05 00:55:24] [ANALYSIS] 📈 Comparación - Proxy URLs: A=0, B=0 | Signed URLs: A=0, B=0
[2025-09-05 00:55:24] [INFO] ⏸️ Pausa de 5 segundos antes del siguiente test...
[2025-09-05 00:55:29] [INFO] 🔄 Test 3/10: Test: Factura cedible SF por solicitante 0012148561
[2025-09-05 00:55:29] [INFO] [Backend-A] 📤 Enviando consulta: 'Puedes darme la factura cedible sf cuyo solicitant...'
[2025-09-05 00:55:29] [INFO] [Backend-A] 📝 Creando sesión: diagnosis-session-20250905_005444-Backend-A-1983668454...
[2025-09-05 00:55:29] [SUCCESS] [Backend-A] ✅ Sesión creada
[2025-09-05 00:55:29] [INFO] [Backend-A] 🔗 Enviando a /run endpoint...
[2025-09-05 00:55:29] [INFO] [Backend-A] ⏱️ Enviando consulta (timeout: 300s para procesamiento completo)...
[2025-09-05 00:55:32] [INFO] [Backend-A] 🔍 DEBUG: Respuesta es array con 3 eventos
[2025-09-05 00:55:32] [INFO] [Backend-A] 🔍 DEBUG: Encontrados 1 eventos del modelo
[2025-09-05 00:55:32] [INFO] [Backend-A] 🔍 DEBUG: Texto extraído: 'No se encontraron facturas cedibles sin firma para el solicitante 0012148561....'
[2025-09-05 00:55:32] [SUCCESS] [Backend-A] ✅ Respuesta recibida (2618.4992ms,  chars)
[2025-09-05 00:55:32] [ERROR] [Backend-A] ❌ Error enviando consulta: Cannot find drive. A drive with the name 'diagnosis_results\response_Backend-A_Test' does not exist.
[2025-09-05 00:55:32] [INFO] [Backend-B] 📤 Enviando consulta: 'Puedes darme la factura cedible sf cuyo solicitant...'
[2025-09-05 00:55:32] [INFO] [Backend-B] 📝 Creando sesión: diagnosis-session-20250905_005444-Backend-B-627234550...
[2025-09-05 00:55:32] [SUCCESS] [Backend-B] ✅ Sesión creada
[2025-09-05 00:55:32] [INFO] [Backend-B] 🔗 Enviando a /run endpoint...
[2025-09-05 00:55:32] [INFO] [Backend-B] ⏱️ Enviando consulta (timeout: 300s para procesamiento completo)...
[2025-09-05 00:55:36] [INFO] [Backend-B] 🔍 DEBUG: Respuesta es array con 3 eventos
[2025-09-05 00:55:36] [INFO] [Backend-B] 🔍 DEBUG: Encontrados 1 eventos del modelo
[2025-09-05 00:55:36] [INFO] [Backend-B] 🔍 DEBUG: Texto extraído: 'No se encontraron facturas cedibles sin firma para el solicitante 0012148561....'
[2025-09-05 00:55:36] [SUCCESS] [Backend-B] ✅ Respuesta recibida (3535.4289ms,  chars)
[2025-09-05 00:55:36] [ERROR] [Backend-B] ❌ Error enviando consulta: Cannot find drive. A drive with the name 'diagnosis_results\response_Backend-B_Test' does not exist.
[2025-09-05 00:55:36] [ANALYSIS] 📈 Comparación - Proxy URLs: A=0, B=0 | Signed URLs: A=0, B=0
[2025-09-05 00:55:36] [INFO] ⏸️ Pausa de 5 segundos antes del siguiente test...
[2025-09-05 00:55:41] [INFO] 🔄 Test 4/10: Test: Facturas cedibles múltiples por solicitante 0012148561
[2025-09-05 00:55:41] [INFO] [Backend-A] 📤 Enviando consulta: 'Puedes darme las facturas cedibles cuyo solicitant...'
[2025-09-05 00:55:41] [INFO] [Backend-A] 📝 Creando sesión: diagnosis-session-20250905_005444-Backend-A-791260768...
[2025-09-05 00:55:41] [SUCCESS] [Backend-A] ✅ Sesión creada
[2025-09-05 00:55:41] [INFO] [Backend-A] 🔗 Enviando a /run endpoint...
[2025-09-05 00:55:41] [INFO] [Backend-A] ⏱️ Enviando consulta (timeout: 300s para procesamiento completo)...
[2025-09-05 00:55:43] [INFO] [Backend-A] 🔍 DEBUG: Respuesta es array con 3 eventos
[2025-09-05 00:55:43] [INFO] [Backend-A] 🔍 DEBUG: Encontrados 1 eventos del modelo
[2025-09-05 00:55:43] [INFO] [Backend-A] 🔍 DEBUG: Texto extraído: 'No se encontraron facturas cedibles para el solicitante 0012148561....'
[2025-09-05 00:55:43] [SUCCESS] [Backend-A] ✅ Respuesta recibida (2293.373ms,  chars)
[2025-09-05 00:55:43] [ERROR] [Backend-A] ❌ Error enviando consulta: Cannot find drive. A drive with the name 'diagnosis_results\response_Backend-A_Test' does not exist.
[2025-09-05 00:55:43] [INFO] [Backend-B] 📤 Enviando consulta: 'Puedes darme las facturas cedibles cuyo solicitant...'
[2025-09-05 00:55:43] [INFO] [Backend-B] 📝 Creando sesión: diagnosis-session-20250905_005444-Backend-B-508186710...
[2025-09-05 00:55:44] [SUCCESS] [Backend-B] ✅ Sesión creada
[2025-09-05 00:55:44] [INFO] [Backend-B] 🔗 Enviando a /run endpoint...
[2025-09-05 00:55:44] [INFO] [Backend-B] ⏱️ Enviando consulta (timeout: 300s para procesamiento completo)...
[2025-09-05 00:55:46] [INFO] [Backend-B] 🔍 DEBUG: Respuesta es array con 3 eventos
[2025-09-05 00:55:46] [INFO] [Backend-B] 🔍 DEBUG: Encontrados 1 eventos del modelo
[2025-09-05 00:55:46] [INFO] [Backend-B] 🔍 DEBUG: Texto extraído: 'No se encontraron facturas cedibles para el solicitante 0012148561....'
[2025-09-05 00:55:46] [SUCCESS] [Backend-B] ✅ Respuesta recibida (2283.974ms,  chars)
[2025-09-05 00:55:46] [ERROR] [Backend-B] ❌ Error enviando consulta: Cannot find drive. A drive with the name 'diagnosis_results\response_Backend-B_Test' does not exist.
[2025-09-05 00:55:46] [ANALYSIS] 📈 Comparación - Proxy URLs: A=0, B=0 | Signed URLs: A=0, B=0
[2025-09-05 00:55:46] [INFO] ⏸️ Pausa de 5 segundos antes del siguiente test...
[2025-09-05 00:55:51] [INFO] 🔄 Test 5/10: facturas_estadisticas_ruts.test
[2025-09-05 00:55:51] [INFO] [Backend-A] 📤 Enviando consulta: 'Dame estadísticas de RUTs únicos: cuántas facturas...'
[2025-09-05 00:55:51] [INFO] [Backend-A] 📝 Creando sesión: diagnosis-session-20250905_005444-Backend-A-1706043762...
[2025-09-05 00:55:51] [SUCCESS] [Backend-A] ✅ Sesión creada
[2025-09-05 00:55:51] [INFO] [Backend-A] 🔗 Enviando a /run endpoint...
[2025-09-05 00:55:51] [INFO] [Backend-A] ⏱️ Enviando consulta (timeout: 300s para procesamiento completo)...
[2025-09-05 00:55:56] [INFO] [Backend-A] 🔍 DEBUG: Respuesta es array con 3 eventos
[2025-09-05 00:55:56] [INFO] [Backend-A] 🔍 DEBUG: Encontrados 1 eventos del modelo
[2025-09-05 00:55:56] [INFO] [Backend-A] 🔍 DEBUG: Texto extraído: 'Aquí tienes las estadísticas de los 10 RUTs únicos con al menos 1 factura:

*   **RUT:** 76742300-4,...'
[2025-09-05 00:55:56] [SUCCESS] [Backend-A] ✅ Respuesta recibida (4500.7762ms,  chars)
[2025-09-05 00:55:56] [INFO] [Backend-B] 📤 Enviando consulta: 'Dame estadísticas de RUTs únicos: cuántas facturas...'
[2025-09-05 00:55:56] [INFO] [Backend-B] 📝 Creando sesión: diagnosis-session-20250905_005444-Backend-B-1446575250...
[2025-09-05 00:55:56] [SUCCESS] [Backend-B] ✅ Sesión creada
[2025-09-05 00:55:56] [INFO] [Backend-B] 🔗 Enviando a /run endpoint...
[2025-09-05 00:55:56] [INFO] [Backend-B] ⏱️ Enviando consulta (timeout: 300s para procesamiento completo)...
[2025-09-05 00:56:01] [INFO] [Backend-B] 🔍 DEBUG: Respuesta es array con 3 eventos
[2025-09-05 00:56:01] [INFO] [Backend-B] 🔍 DEBUG: Encontrados 1 eventos del modelo
[2025-09-05 00:56:01] [INFO] [Backend-B] 🔍 DEBUG: Texto extraído: 'Aquí tienes las estadísticas de los 10 RUTs únicos con al menos 1 factura:

*   **RUT: 76742300-4**
...'
[2025-09-05 00:56:01] [SUCCESS] [Backend-B] ✅ Respuesta recibida (4544.9847ms,  chars)
[2025-09-05 00:56:01] [ANALYSIS] 📈 Comparación - Proxy URLs: A=0, B=0 | Signed URLs: A=0, B=0
[2025-09-05 00:56:01] [INFO] ⏸️ Pausa de 5 segundos antes del siguiente test...
[2025-09-05 00:56:06] [INFO] 🔄 Test 6/10: Test: Búsqueda por fecha específica 2019-12-26
[2025-09-05 00:56:06] [INFO] [Backend-A] 📤 Enviando consulta: 'Puedes darme las facturas del 26 de diciembre de 2...'
[2025-09-05 00:56:06] [INFO] [Backend-A] 📝 Creando sesión: diagnosis-session-20250905_005444-Backend-A-471194122...
[2025-09-05 00:56:06] [SUCCESS] [Backend-A] ✅ Sesión creada
[2025-09-05 00:56:06] [INFO] [Backend-A] 🔗 Enviando a /run endpoint...
[2025-09-05 00:56:06] [INFO] [Backend-A] ⏱️ Enviando consulta (timeout: 300s para procesamiento completo)...
[2025-09-05 00:56:09] [INFO] [Backend-A] 🔍 DEBUG: Respuesta es array con 3 eventos
[2025-09-05 00:56:09] [INFO] [Backend-A] 🔍 DEBUG: Encontrados 1 eventos del modelo
[2025-09-05 00:56:09] [INFO] [Backend-A] 🔍 DEBUG: Texto extraído: 'No pude encontrar ninguna factura para el 26 de diciembre de 2019. ¿Hay alguna otra fecha que te int...'
[2025-09-05 00:56:09] [SUCCESS] [Backend-A] ✅ Respuesta recibida (2487.4221ms,  chars)
[2025-09-05 00:56:09] [ERROR] [Backend-A] ❌ Error enviando consulta: Cannot find drive. A drive with the name 'diagnosis_results\response_Backend-A_Test' does not exist.
[2025-09-05 00:56:09] [INFO] [Backend-B] 📤 Enviando consulta: 'Puedes darme las facturas del 26 de diciembre de 2...'
[2025-09-05 00:56:09] [INFO] [Backend-B] 📝 Creando sesión: diagnosis-session-20250905_005444-Backend-B-1178905023...
[2025-09-05 00:56:09] [SUCCESS] [Backend-B] ✅ Sesión creada
[2025-09-05 00:56:09] [INFO] [Backend-B] 🔗 Enviando a /run endpoint...
[2025-09-05 00:56:09] [INFO] [Backend-B] ⏱️ Enviando consulta (timeout: 300s para procesamiento completo)...
[2025-09-05 00:56:11] [INFO] [Backend-B] 🔍 DEBUG: Respuesta es array con 3 eventos
[2025-09-05 00:56:11] [INFO] [Backend-B] 🔍 DEBUG: Encontrados 1 eventos del modelo
[2025-09-05 00:56:11] [INFO] [Backend-B] 🔍 DEBUG: Texto extraído: 'No se encontraron facturas para el 26 de diciembre de 2019....'
[2025-09-05 00:56:11] [SUCCESS] [Backend-B] ✅ Respuesta recibida (2250.1184ms,  chars)
[2025-09-05 00:56:11] [ERROR] [Backend-B] ❌ Error enviando consulta: Cannot find drive. A drive with the name 'diagnosis_results\response_Backend-B_Test' does not exist.
[2025-09-05 00:56:12] [ANALYSIS] 📈 Comparación - Proxy URLs: A=0, B=0 | Signed URLs: A=0, B=0
[2025-09-05 00:56:12] [INFO] ⏸️ Pausa de 5 segundos antes del siguiente test...
[2025-09-05 00:56:17] [INFO] 🔄 Test 7/10: Test: Búsqueda por Mes y Año Específico
[2025-09-05 00:56:17] [INFO] [Backend-A] 📤 Enviando consulta: 'Busca facturas de diciembre 2019...'
[2025-09-05 00:56:17] [INFO] [Backend-A] 📝 Creando sesión: diagnosis-session-20250905_005444-Backend-A-221603829...
[2025-09-05 00:56:17] [SUCCESS] [Backend-A] ✅ Sesión creada
[2025-09-05 00:56:17] [INFO] [Backend-A] 🔗 Enviando a /run endpoint...
[2025-09-05 00:56:17] [INFO] [Backend-A] ⏱️ Enviando consulta (timeout: 300s para procesamiento completo)...
