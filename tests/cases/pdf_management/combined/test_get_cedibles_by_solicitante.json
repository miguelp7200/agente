{
    "test_case": "get_cedibles_by_solicitante",
    "description": "Obtener todas las copias cedibles (CF y SF) de un solicitante",
    "category": "pdf_management",
    "subcategory": "combined",
    "test_data": {
        "input": {
            "query": "dame todas las copias cedibles del solicitante 0012148561",
            "params": {
                "expected_solicitante": "0012148561",
                "expected_pdf_type": "cedible",
                "expected_table": "pdfs_modelo"
            }
        },
        "expected_behavior": {
            "expected_tool": "get_cedibles_by_solicitante",
            "expected_columns": [
                "Factura",
                "Solicitante",
                "Rut",
                "Nombre",
                "Copia_Cedible_cf",
                "Copia_Cedible_sf"
            ],
            "expected_count_range": {
                "min": 1,
                "max": 50,
                "typical": 20
            }
        },
        "actual_results": {
            "validation_pending": true,
            "notes": "Test combinado para PDFs cedibles CF+SF. Parámetro pdf_type='cedible' devuelve ambos tipos."
        }
    },
    "validation_criteria": {
        "criterion_1_tool_selection": {
            "description": "El agente debe seleccionar get_cedibles_by_solicitante",
            "validation_method": "Verificar campo 'tool_name' en response",
            "expected_value": "get_cedibles_by_solicitante",
            "priority": "high"
        },
        "criterion_2_solicitante_parsing": {
            "description": "El código de solicitante debe parsearse correctamente",
            "validation_method": "Verificar parámetro 'solicitante' = '0012148561'",
            "expected_value": "0012148561",
            "priority": "high"
        },
        "criterion_3_pdf_type_filter": {
            "description": "El parámetro pdf_type debe ser 'cedible' o incluir ambos tipos",
            "validation_method": "Verificar pdf_type en argumentos = 'cedible'",
            "expected_value": "cedible",
            "priority": "high"
        },
        "criterion_4_cedible_urls_both": {
            "description": "Deben retornarse URLs de PDFs cedibles CF y/o SF",
            "validation_method": "Verificar que Copia_Cedible_cf o Copia_Cedible_sf están presentes",
            "expected_value": "cedibles_cf_or_sf",
            "priority": "high"
        },
        "criterion_5_solicitante_match": {
            "description": "Todas las facturas deben pertenecer al solicitante especificado",
            "validation_method": "Verificar que Solicitante = '0012148561' en todos los resultados",
            "expected_value": "all_solicitantes_match",
            "priority": "high"
        }
    },
    "technical_details": {
        "mcp_toolbox_logs": {
            "expected_log_entries": [
                "INFO: Ejecutando get_cedibles_by_solicitante",
                "INFO: Parámetros: {'solicitante': '0012148561', 'pdf_type': 'cedible'}",
                "INFO: Filtrando PDFs cedibles (CF y SF)"
            ]
        },
        "bigquery_query_pattern": "SELECT Factura, Solicitante, Rut, Nombre, Copia_Cedible_cf, Copia_Cedible_sf FROM `datalake-gasco.sap_analitico_facturas_pdf_qa.pdfs_modelo` WHERE Solicitante = '0012148561' AND (Copia_Cedible_cf IS NOT NULL OR Copia_Cedible_sf IS NOT NULL) LIMIT 50",
        "timeout_seconds": 1200,
        "retry_strategy": "none"
    },
    "business_impact": {
        "user_facing": true,
        "criticality": "high",
        "use_cases": [
            "Obtención completa de copias cedibles para factoring",
            "Gestión de documentos cedibles de un solicitante",
            "Procesamiento masivo de facturas cedibles"
        ],
        "priority_level": "P1"
    }
}